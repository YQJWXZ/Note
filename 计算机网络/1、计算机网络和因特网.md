# 1、计算机网络和因特网
## 1.1 Internet
### 1.1.1 网络 
可靠特性要素： 不出错、不丢失、不重复、不失序

 ### 1.1.2 计算机网络

1. 节点
	* 主机及其上运行的应用程序
	* 路由器、交换机等网络设备
2. 边：通信链路
	* 接入网链路：主机连接到互联网的链路
	* 主干链路：路由器间的链路
3. 协议
对等层实体在通信过程当中应该遵守的规则的集合

``基础设施：主机、应用层以下的所有的应用协议实体、目标主机当中的应用层以下的所有协议实体``

### 1.1.3 互联网

## 1.2 网络边缘（Edge）
1. 主机（端系统）
	* 运行应用程序
	* Web、Email
2. 客户/服务器模式
	* 客户端向服务器请求、接收服务
	* 如Web浏览器/服务器 ; email客户端/服务器
	* 可扩展性差
3. 对等（peer - peer）模式
	* 很少（甚至没有）专门的服务器
	* 文件式的分发系统
	* 如Gnutella、KaZaA、Emule
4. 采用网络设施的面向连接服务
	目标：在端系统之间传输数据
	* TCP-传输控制协议
		* TCP服务
			* 可靠地、按顺序地传送数据
			* 流量控制：协调双方的网络出路能力
			* 拥塞控制：考虑实时的链路状态
		* 使用TCP的应用：HTTP、FTP、Telent、SMTP
	* UDP-用户数据报协议
		* 无连接
		* 不可靠数据传输
		* 无流量控制
		* 无拥塞控制
		* 使用UDP的应用： 流媒体、远程会议、DNS、Internet电话
## 1.3 网络核心
* 互联着的路由器、交换机的网状网络
	``数据怎样通过网络进行传输：电路交换(资源预留)、分组交换``
* 处理延迟、排队延迟、传输延迟、传播延迟
* 通信网络
	* 电路交换网络： FDM、TDM
	* 分组交换网络：虚电路网络（有连接）、数据报网络
## 1.4 接入网（access）、物理媒体
 	1. 接入网
 	 	* 住宅接入： modem(调幅、调频、相位)、DSL、线缆网络、电缆模式、家庭网络
 	 	* 企业接入： 以太网交换机
 	 	* 无线接入网络：无线LANS、广域无线接入
 	2. 物理媒体（同轴电缆、光纤和光缆）
 	 	* 物理链路
 	 	* 导引型媒体
 	 	* 非导引型媒体： 比如电磁波

## 1.5 Internet结构和ISP

* 网络的网络
  	* 网络结构1:  ``全球承载ISP``
  	* 网络结构2： ``接入ISP``
  	* 网络结构3:   ``区域ISP``
  	* 网络结构4： ``接入ISP、区域ISP、第一层ISP、Pop、多宿、对等、IXP``
  	* 网络结构5： ``ICP``

	* ISP(因特网服务商，提供接入，提供网) 、ICP（互联网内容提供商，提供业务）、IXP（互联网交换中心，多个ISP互联）
	* ISP之间的连接：POP（高层 --> 低层）、对等接入、IXP、ICP自己部署专用网络
	* 端系统通过**接入ISP**连接到互联网
	* 可扩展性（scalability   时间复杂度）
## 1.6 分组延时、丢失和吞吐量

1. 处理时延、排队时延、传输时延、传播时延

2. 传输时延与传播时延的比较

   * 传输时延：路由器将分组推出所需要的时间，是分组长度和链路传输速率的函数，与路由器之间的距离无关
   * 传播时延：一个比特从一台路由器向另一台路由器传播所需要的时间，是两台路由器之间距离的函数，与分组长度或链接速率无关

3. 排队时延

	* 流量强度（设计系统时流量强度不能大于1）
	* 周期性到达、突发性到达

4. 分组丢失、延时
	* 分组到达链路的速率超过了链路输出的能力
	* ICMP（ttl生存周期，一个报文每经过一跳就将ttl减1，当ttl为0时，该报文被丢弃，默认ttl为255  tracert/traceroute）
5. 瞬时吞吐量、平均吞吐量
	* 短板（木桶）效应
	* 瓶颈链路
## 1.7 协议层次及服务模型

服务与协议的区别：
* 服务： 低层实体向上层实体提供它们之间的通信的能力，是通过原语(primitive)来操作的，**垂直**
* 协议： 对等层实体之间在相互通信的过程中，需要遵循的规则的集合，**水平**

服务与协议的联系：
*  协议的实现借助于下层提供的服务才能实现
* 协议实现的目的是为了向上层提供更好的服务

###  五层因特网协议栈
* 应用层： HTTP、SMTP、FTP、DNS 
* 传输层： TCP、UDP
* 网络层： IP协议、路由选择协议
* 链路层： 以太网（双绞铜线、同轴电缆、光纤）、WiFi、电缆接入网的DOCSIS协议
* 物理层

###  OSI七层模型

* 应用层： 为应用程序提供服务；如Web应用
* 表示层： 数据格式转化（压缩）、数据加密、数据描述
* 会话层： 建立、管理和维护会话；如不同软件数据分发给不同软件
* 传输层： 建立、管理和维护端到端的连接；如UDP、TCP ，数据被称为**段**
* 网络层：IP地址及路由选择；如不同设备的数据转发``实现寻址``，数据被称为**分组packet**
* 数据链路层：提供介质访问和链路管理，定义数据的基本格式，如何传输，如何标识；如网卡MAC地址``典型协议：以太网、帧中继（古董级VPN）``，数据被称为*帧**
* 物理层：底层数据传输；如网线、网卡标准，数据被称为**比特流**



## 1.8 完整的HTTP请求

1. 建立起客户机与服务器连接
2. 建立连接后，客户机发送一个请求给服务器
3. 服务器收到请求给予响应信息
4. 客户端浏览器将返回的内容解析并呈现，断开连接

> 域名解析 --> 发起TCP的三次握手 -->  建立TCP连接后发起http请求 --> 服务器响应http请求，浏览器得到html代码 --> 浏览器解析html代码，并请求html代码中的资源 --> 浏览器对页面进行渲染呈现给用户

## 1.9 DNS

###  什么是DNS
域名系统，因特网作为域名和IP地址相互映射的一个分布式数据库

通过主机名，最终得到该主机名对应的IP地址的过程叫做域名解析（或主机名解析）

### DNS的工作原理
1. 用户输入域名，浏览器先检查自己的缓存中是否包含这个域名映射的ip地址，有 --> 解析结束
2. 若没命中，则检查操作系统缓存(Windows的hosts)中有没有解析过的结果，有 --> 解析结束
3. 若没命中，则请求本地域名服务器解析(LDNS)
4. 若LDNS没有命中就直接跳到根域名服务器请求解析。根域名服务器返回给LDNS一个主域名服务器地址
5. 此时LDNS再发送请求给上一步返回的GTLD（通用顶级域），接受请求的GTLD查找并返回这个域名对应的Name Server的地址
6. Name Sever根据映射关系表找到目标ip，返回给LDNS
7. LDNS缓存这个域名和对应的ip，把解析的结果返回给用户，用户根据TTL值缓存到本地系统缓存中，域名解析过程结束


> 主机向本地域名服务器的查询一般都是采用递归查询
> 
> 本地域名服务器向根域名服务器的查询是迭代查询
> 
> **将主机域名转换为ip地址，属于应用层协议，使用UDP传输**


## 1.10 TCP粘包/拆包

拆包： 一个完整的业务可能会把TCP拆成多个包进行发送
粘包： 可能会把多个小的包装成一个大的数据包发送

产生原因：
1. 应用程序写入数据的字节大小大于套接字发送缓冲区的大小
2. 进行MSS大小的TCP分段(MSS=TCP报文段长度-TCP首部长度)
3. 以太网的payload大于MTU进行IP分片（MTU: 一种通信协议的某一层上面所能通过的最大数据包大小）

解决方案：
1. 消息定长
2. 在包尾部增加回车或者空格符等特殊字符进行分割
3. 将消息分为消息头和消息尾
4. 使用其他复杂的协议，如RTMP协议等

### 1.10 GET 和 POST 的区别

1. get是获取数据，POST是修改数据
2. get把请求的数据放在url上，以?分割URL和传输数据，参数之间以&相连，所以get不太安全。而pos则是把数据放在http的包体内（request body 相对安全）