# 2、应用层
## 2.1 常见的体系结构
1. C/S体系结构
	* 服务器
		* 一直运行
		* 固定的IP地址环绕周边的端口号（约定）
		* 扩展性：服务器场（数据中心进行扩展、扩展性差）
	* 客户端
		* 主动与服务器通信
		* 与互联网有间歇性的连接
		* 可能是动态IP地址
		* 不直接与其它客户端通信

2. P2P体系结构
	*  没有一直运行的服务器
	*  任意端系统之间可以进行通信
	*  每一个节点既是客户端又是服务器
		* 自扩展性-新peer节点带来新的服务能力，当然也带来新的服务请求
	* 参与的主机间歇性连接且可以改变IP地址（难以管理）
	* 例子：GnutElla，迅雷

3. 混合体
	Napster：
	* 文件搜索：集中
		* 主机在中心服务器上注册其资源
		* 主机向中心服务器查询资源位置
	* 文件传输：P2P
		* 任意peer节点之间
		即时通信：
	* 在线检测：集中
		* 当用户上线时，向中心服务器注册其IP地址
		* 用户与中心服务器联系，以找到其在线好友的位置
	* 两个用户之间聊天：P2P

## 2.2 应用层原理
### 2.2.1 进程通信
1. 进程：在主机上运行的应用程序
	* 在同一个主机内，使用进程间通信机制通信
	* 不同主机，通过交换报文来通信
		* 使用OS提供的通信服务
		* 按照应用协议交换报文（借助传输层提供的服务）

### 2.2.2 分布式进程通信需要解决的问题
1. 进程标示与寻址问题（服务用户）
	* 进程为了接收报文，必须有一个标识，即：SAP（发送也需要标识）
		* 主机：唯一的32位IP地址
		* 所采用的传输层协议：TCP or UDP
		* 端口号(Port)
	* 一些常见端口号的例子：
		* HTTP:  TCP 80
		* Mail:  TCP 25
		* ftp:  TCP 2
	* 一个进程：用IP+port标识 端节点（end port）
	* 本质上，一对主机进程之间的通信由2个端节点构成

2. 传输层-应用层如何提供服务（服务）
	* 位置：层间界面的SAP（TCP/IP:  socket）
		* 层间接口必须要携带的信息：
			* 要传输的报文（对于本层来说：SDU）
			* 谁传的：对方的应用进程的标示：IP+TCP（UDP）端口
			* 传给谁：对方的应用进程的标示：对方的IP+TCP（UDP）端口
		* 传输层实体（tcp或者udp实体）根据这些信息进行TCP报文段（UDP数据报）的封装
			* 源端口号，目标端口号，数据等
			* 将IP地址往下交IP实体，用于封装IP数据报：源IP，目标IP
	* 形式：应用程序接口API（TCP/IP：socket API）
3. 传输层提供的服务--层间信息的代表
	* TCP之上的套接字(socket)
		* 对于使用面向连接服务(TCP)的应用而言，套接字是4元组的一个具有本地意义的标示
		* 唯一的指定了一个会话(2个进程之间的会话关系)
		* 不必在每一个报文的发送都要指定这4元组
	* TCP scoket
		* TCP服务，两个进程之间的通信需要之前建立连接
			* 两个进程之间通信会持续一段时间，通信关系稳定
		* 可以用一个整数表示两个应用实体之间的通信关系，本地标示
		* 穿过层间接口的信息量最小
		* TCP socket: 源IP，源端口，目标IP，目标端口的本地标示
	* UDP之上的套接字(socket)
		* 对于使用无连接的服务(UDP)的应用而言，套接字是2元组的一个具有本地意义的标示
			* 2元组：IP、port（源端指定）
			* UDP套接字指定了应用所在的一个端节点
			* 在发送数据报时，采用创建好的本地套接字，就不必在发送每个报文中指明自己所采用的的ip和port
			* 但是在发送报文时，必须要指定对方的ip和udp port(另外一个端节点)
	* UDP socket
		* UDP服务，两个进程之间的通信需要之前无需建立连接
			* 每个报文都是独立传输的
			* 前后报文可能给不同的分布式进程
		* 因此，只能用一个整数表示本应用实体的标示
			* 因为这个报文可能传给另外一个分布式进程
		* 穿过层间接口的信息大小最小
		* UDP socket：本IP，本端口
			* 但是传输报文时，必须提供对方IP，port
				* 接收报文时，传输层需要上传对方的IP，port
4. 如何使用传输层提供的服务，实现应用进程之间的报文转换，实现应用（用户使用服务）
	* 定义应用层协议：报文类型、报文类型的语法、字段的语义、解释、时序等
		* 公开协议：由RFC文档定义、允许互操作，如HTTP、SMTP
		* 专用（私有）协议：如Skype
		* 应用协议仅仅是应用的一个组成部分
	* 应用需要传输层提供什么样的服务：可靠数据传输、吞吐量、定时、安全性
5. UDP存在的必要性
	* 能够区分不同的进程，而IP服务不能
	* 无需建立连接
	* 不做可靠性的工作
	* 没有拥塞控制和流量控制，应用能够按照设定的速度发送数据
## 2.2 Web and HTTP

## 2.3 FTP
## 2.4 EMail
## 2.5 DNS
## 2.6 P2P
## 2.7 CDN
## 2.8 TCP套接字(Socket)编程
## 2.9 UDP套接字编程